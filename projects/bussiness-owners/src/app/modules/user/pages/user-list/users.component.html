<lib-page-content>
  <div class="user_page mt-4">
    <lib-data-table
      [items]="userData"
      [tableConfigs]="{
        columns: [
          {name: 'name',headerText: ('User.Name' | translate),isGlobalFilter: true,isSortable: true,template: userCol},
          {name: 'email',headerText: ('User.Email' | translate),isGlobalFilter: true,isSortable: true},
          {name: 'category',headerText: ('User.Category' | translate),isGlobalFilter: true,isSortable: true},
          {name: 'lastLoginDate',headerText: ('User.LastLogin' | translate),isGlobalFilter: true,isSortable: true},
          {name: 'invitationStatus',headerText: ('User.Status' | translate),isGlobalFilter: true},
          {name: 'name',headerText: ('User.Actions' | translate),template: actionsCol}]
      }"
    >
      <ng-container caption>
        <div class="flex align-items-center justify-content-end">
          <span class="p-input-icon-left">
            <i class="pi pi-search"></i>
            <input pInputText type="text" (input)="applyFilterGlobal($event, 'contains')"
              placeholder="Search..."
            />
          </span>
          <button pButton pRipple label="Add New" icon="pi pi-plus"
            class="add_new mr-2" (click)="openInviteModal()"
          ></button>
        </div>
      </ng-container>
    </lib-data-table>

    <ng-template #userCol let-user>
      <div class="user_info">
        <img [src]="getProfilePic(user.id)" onerror="this.src='assets/images/users/pic.jpg'"
          width="50" class="shadow-4 img_user"/>
        <p>{{ user.name }}</p>
      </div>
    </ng-template>

    <ng-template #actionsCol let-user>
      <p-button icon="pi pi-pencil" (click)="editUser(user.id)"
        [rounded]="true" [text]="true" severity="secondary "
        *ngIf="user.invitationStatus == 2"></p-button>
      <p-button icon="pi pi-trash" [rounded]="true" [text]="true" severity="danger">
      </p-button>

      <div class="checked" *ngIf="user.invitationStatus == 2">
        <p-inputSwitch [id]="user.id" (onChange)="changed($event, user.id)"
          [(ngModel)]="user.isActive">
        </p-inputSwitch>
        <p class="active" *ngIf="user.isActive">
          {{ "User.Activate" | translate }}
        </p>
        <p class="inactive" *ngIf="!user.isActive">
          {{ "User.Deactivate" | translate }}
        </p>
      </div>
      <div class="checked">
        <button class="resend" (click)="resendInvitation(user.id)"
          *ngIf="user.invitationStatus == 1">
          <p class="title">{{ "User.Resend" | translate }}</p>
          <p class="ico_mail pi pi-envelope"></p>
        </button>
      </div>
    </ng-template>
  </div>
</lib-page-content>
