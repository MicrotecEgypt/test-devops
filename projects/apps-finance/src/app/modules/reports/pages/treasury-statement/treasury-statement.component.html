<lib-page-content>
  <div class="user_page group">
    <form [formGroup]="reportForm">
      <div class="group">
        <div class="calender"></div>
          <div class="grid">
            <div class="col-12 md:col-6">
              <lib-text-input [type]="'date'" formControlName="dateFrom"> </lib-text-input>
            </div>
            <div class="col-12 md:col-6">
              <lib-text-input [type]="'date'" formControlName="dateTo"> </lib-text-input>
            </div>
          </div>
        </div>

        <div class="grid">
          <div class="col-12 md:col-5">
          <lib-select
              formControlName="treasuryId"
              [options]="treasuryDropDown"
              optionValue="id"
              optionLabel="name"
            >
            </lib-select>
          </div>
          <div class="col-12 md:col-4">
            <lib-text-input 
                type="text" 
                formControlName="currency" 
                [readOnly]="true" 
                />
          </div>
          <div class="col-12 md:col-3">
            <div class="all_btn">
              <lib-button-micro
                [title]="'TreasuryStatement.ViewData' | translate"
                nameClass="save"
                iconName="pi pi-circle"
                (click)="getReportData()"
              >
              </lib-button-micro>
              <button class="btn_ex" (click)="printTable('printableTable')">
                <span class="pi pi-print"></span>
              </button>
            </div>
          </div>
        </div>
    </form>

      <lib-data-table
      *ngIf="tableData.transactions"
      [firstRow]="true"
        [items]="tableData.transactions"
        className="p-datatable-gridlines"
        [reportTable]="true"
        [tableConfigs]="{
                allowPagination: false,
                allowServerPagination: false,
                dataKey: 'id',
                pageSize: 10,
                columns: [
                  {
                    name: 'date',
                    headerText: 'TreasuryStatement.date' | translate,
                    template:date
                  },
                  {
                    name: 'paymentCode',
                    headerText: 'TreasuryStatement.paymentCode' | translate,
                  },
                  {
                    name: 'paymentName',
                    headerText: 'TreasuryStatement.paymentName' | translate,
                  },{
                    name: 'debit',
                    headerText: 'TreasuryStatement.debit' | translate,
                  },
                  {
                    name: 'credit',
                    headerText: 'TreasuryStatement.credit' | translate,
                  },
                  {
                    name: 'balance',
                    headerText: 'TreasuryStatement.balance' | translate,
                  },
                  {
                    name: 'paymentMethodName',
                    headerText: 'TreasuryStatement.paymentMethodName' | translate,
                  },
                  {
                    name: 'sourceCode',
                    headerText: 'TreasuryStatement.sourceCode' | translate,
                  },
                  {
                    name: 'journalCode',
                    headerText: 'TreasuryStatement.journalCode' | translate,
                  },
                  {
                    name: 'paidByDetails',
                    headerText: 'TreasuryStatement.paidByDetailsName' | translate,
                  },
                  {
                    name: 'linkedGLAccount',
                    headerText: 'TreasuryStatement.accountName' | translate,
                  },
                  {
                    name: 'headerDescription',
                    headerText: 'TreasuryStatement.headerDescription' | translate,
                  },
                  {
                    name: 'lineDescription',
                    headerText: 'TreasuryStatement.lineDescription' | translate,
                  }
                ]
              }"
      >
       
        <ng-template #date let-account>
          <div>
            <p>{{ account.date | date : 'MM/dd/yyyy' }}</p>
          </div>
        </ng-template>

        <ng-container firstRow>
          <td class="imptyData"></td>
          <td class="imptyData"></td>
          <td class="imptyData"></td>
          <td class="total">{{ generalService.formatNumber(  tableData.openingBalanceDebit, generalService.fraction) }}</td>
          <td class="total">{{ generalService.formatNumber(  tableData.openingBalanceCredit, generalService.fraction)}}</td>
          <td class="total">{{ generalService.formatNumber(  tableData.openingBalanceBalance, generalService.fraction)}}</td>
          <td class="imptyData"></td>      
          </ng-container>
          
        <ng-container footer>
          <tr>
            <td class="imptyData"></td>
            <td class="imptyData"></td>
            <td class="imptyData"></td>
            <td class="total">{{ generalService.formatNumber(  tableData.totalDebit, generalService.fraction) }}</td>
            <td class="total">{{ generalService.formatNumber(  tableData.totalCredit, generalService.fraction)}}</td>
            <td class="total">{{ generalService.formatNumber(  tableData.totalBalance, generalService.fraction)}}</td>
            <td class="imptyData"></td>
          </tr>
        </ng-container>
      </lib-data-table>


      <div id="printableTable">
        <form [formGroup]="reportForm">
      <div class="group">
        <div class="calender"></div>
          <div class="grid">
            <div class="col-12 md:col-6">
              <lib-text-input [type]="'date'" formControlName="dateFrom"> </lib-text-input>
            </div>
            <div class="col-12 md:col-6">
              <lib-text-input [type]="'date'" formControlName="dateTo"> </lib-text-input>
            </div>
          </div>
        </div>

        <div class="grid">
          <div class="col-12 md:col-5">
            <lib-multi-select
            formControlName="treasuryId"
            [options]="treasuryDropDown"
            optionValue="id"
            optionLabel="name"
            [selectedValue]="defoultSelectedAcounts"
          ></lib-multi-select>
          </div>
          <div class="col-12 md:col-4">
            <lib-text-input 
                type="text" 
                formControlName="currency" 
                [readOnly]="true" 
                />
          </div>
        </div>
    </form>
        
    <lib-data-table
    *ngIf="tableData.transactions"
      [items]="tableData.transactions"
      className="p-datatable-gridlines"
      [reportTable]="true"
      [tableConfigs]="{
              allowPagination: false,
              allowServerPagination: false,
              dataKey: 'id',
              pageSize: 10,
              columns: [
                {
                  name: 'date',
                  headerText: 'TreasuryStatement.date' | translate,
                  template:date
                },
                {
                  name: 'paymentCode',
                  headerText: 'TreasuryStatement.paymentCode' | translate,
                },
                {
                  name: 'paymentName',
                  headerText: 'TreasuryStatement.paymentName' | translate,
                },{
                  name: 'debit',
                  headerText: 'TreasuryStatement.debit' | translate,
                },
                {
                  name: 'credit',
                  headerText: 'TreasuryStatement.credit' | translate,
                },
                {
                  name: 'balance',
                  headerText: 'TreasuryStatement.balance' | translate,
                },
                {
                  name: 'paymentMethodName',
                  headerText: 'TreasuryStatement.paymentMethodName' | translate,
                },
                {
                  name: 'sourceCode',
                  headerText: 'TreasuryStatement.sourceCode' | translate,
                },
                {
                  name: 'journalCode',
                  headerText: 'TreasuryStatement.journalCode' | translate,
                },
                  {
                    name: 'paidByDetails',
                    headerText: 'TreasuryStatement.paidByDetailsName' | translate,
                  },
                  {
                    name: 'linkedGLAccount',
                    headerText: 'TreasuryStatement.accountName' | translate,
                  },
                {
                  name: 'headerDescription',
                  headerText: 'TreasuryStatement.headerDescription' | translate,
                },
                {
                  name: 'lineDescription',
                  headerText: 'TreasuryStatement.lineDescription' | translate,
                }
              ]
            }"
    >
     
      <ng-template #date let-account>
        <div>
          <p>{{ account.date | date : 'MM/dd/yyyy' }}</p>
        </div>
      </ng-template>

      <ng-container footer>
        <tr>
          <td class="imptyData"></td>
          <td class="imptyData"></td>
          <td class="imptyData"></td>
          <td class="total">{{ generalService.formatNumber(  tableData.totalDebit, generalService.fraction) }}</td>
          <td class="total">{{ generalService.formatNumber(  tableData.totalCredit, generalService.fraction)}}</td>
          <td class="total">{{ generalService.formatNumber(  tableData.totalBalance, generalService.fraction)}}</td>
          <td class="imptyData"></td>
        </tr>
      </ng-container>
    </lib-data-table>
        </div>
      </div>
</lib-page-content>
