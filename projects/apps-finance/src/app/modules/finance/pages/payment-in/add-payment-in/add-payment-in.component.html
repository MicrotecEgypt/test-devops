<lib-page-content>
  <form [formGroup]="addForm">
    <div class="grid m-0">
      <div class="md:col-4">
        <lib-form-group>
          <lib-label [appControl]="addForm.controls['code']">
            {{ 'PaymentIn.Form.Code' | translate }}
          </lib-label>
          <lib-text-input
            type="text"
            formControlName="code"
            [readOnly]="true"
            [placeholder]="'PaymentIn.Form.PlaceholderCode' | translate"
          />
        </lib-form-group>
      </div>

      <div class="md:col-4">
        <lib-form-group>
          <lib-label [appControl]="addForm.controls['journalDate']">
            {{ 'PaymentIn.Form.Date' | translate }}
          </lib-label>
          <lib-calendar
            formControlName="journalDate"
            [placeholder]="'PaymentIn.Form.PlaceholderDate' | translate"
          ></lib-calendar>
        </lib-form-group>
      </div>

      <div class="md:col-4">
        <lib-form-group>
          <lib-label [appControl]="addForm.controls['description']">
            {{ 'PaymentIn.Form.Description' | translate }}
          </lib-label>
          <lib-text-input
            type="text"
            formControlName="description"
            [placeholder]="'PaymentIn.Form.PlaceholderDescription' | translate"
          />
        </lib-form-group>
      </div>

      <div class="md:col-4">
        <lib-form-group>
          <lib-label [appControl]="addForm.controls['paymentHubId']">
            {{ 'PaymentIn.Form.PaymentHub' | translate }}
          </lib-label>
          <lib-select
            formControlName="paymentHubId"
            [options]="paymentHubs"
            optionValue="id"
            optionLabel="name"
            [placeholder]="'PaymentIn.Form.PlaceholderPaymentHub' | translate"
          ></lib-select>
        </lib-form-group>
      </div>

      <div class="md:col-4">
        <lib-form-group>
          <lib-label [appControl]="addForm.controls['paymentHubDetails']">
            {{ 'PaymentIn.Form.PaymentHubDetails' | translate }}
          </lib-label>
          <lib-select
            formControlName="paymentHubDetails"
            [options]="paymentHubs"
            optionValue="id"
            optionLabel="name"
            [placeholder]="'PaymentIn.Form.PlaceholderPaymentHubDetails' | translate"
          ></lib-select>
        </lib-form-group>
      </div>

      <div class="md:col-4">
        <lib-form-group>
          <lib-label [appControl]="addForm.controls['bankAccountId']">
            {{ 'PaymentIn.Form.BankAccount' | translate }}
          </lib-label>
          <lib-select
            formControlName="bankAccountId"
            [options]="bankAccounts"
            optionValue="id"
            optionLabel="name"
            [placeholder]="'PaymentIn.Form.PlaceholderBankAccount' | translate"
          ></lib-select>
        </lib-form-group>
      </div>

      <div class="md:col-4">
        <lib-form-group>
          <lib-label [appControl]="addForm.controls['currency']">
            {{ 'PaymentIn.Form.Currency' | translate }}
          </lib-label>
          <lib-text-input
            type="text"
            formControlName="currency"
            [placeholder]="'PaymentIn.Form.PlaceholderCurrency' | translate"
            [readOnly]="true"
          />
        </lib-form-group>
      </div>

      <div class="md:col-4">
        <lib-form-group>
          <lib-label [appControl]="addForm.controls['rate']">
            {{ 'PaymentIn.Form.Rate' | translate }}
          </lib-label>
          <lib-text-input
            type="number"
            formControlName="rate"
            [placeholder]="'PaymentIn.Form.PlaceholderRate' | translate"
          />
        </lib-form-group>
      </div>

      <div class="md:col-4">
        <lib-form-group>
          <lib-label [appControl]="addForm.controls['sourceDocument']">
            {{ 'PaymentIn.Form.SourceDocument' | translate }}
          </lib-label>
          <lib-text-input
            type="text"
            formControlName="sourceDocument"
            [placeholder]="'PaymentIn.Form.PlaceholderSourceDocument' | translate"
            [readOnly]="true"
          />
        </lib-form-group>
      </div>

      <div class="md:col-4">
        <lib-form-group>
          <lib-label [appControl]="addForm.controls['createdJournal']">
            {{ 'PaymentIn.Form.CreatedJournal' | translate }}
          </lib-label>
          <lib-text-input
            type="text"
            formControlName="createdJournal"
            [placeholder]="'PaymentIn.Form.PlaceholderCreatedJournal' | translate"
            [readOnly]="true"
          />
        </lib-form-group>
      </div>
    </div>
      <div class="grid border">
        <div class="md:col-4">
          <lib-form-group>
            <lib-label [appControl]="addForm.controls['currentBalance']">
              {{ 'PaymentIn.Form.CurrentBalance' | translate }}
            </lib-label>
            <lib-text-input
              type="text"
              formControlName="currentBalance"
              [readOnly]="true"
              [placeholder]="'PaymentIn.Form.PlaceholderCurrentBalance' | translate"
            />
          </lib-form-group>
        </div>

        <div class="md:col-4">
          <lib-form-group>
            <lib-label [appControl]="addForm.controls['totalReceivedAmount']">
              {{ 'PaymentIn.Form.TotalReceivedAmount' | translate }}
            </lib-label>
            <lib-text-input
              type="text"
              formControlName="totalReceivedAmount"
              [placeholder]="'PaymentIn.Form.PlaceholderTotalReceivedAmount' | translate"
              [readOnly]="true"
            />
          </lib-form-group>
        </div>

        <div class="md:col-4">
          <lib-form-group>
            <lib-label [appControl]="addForm.controls['newBalance']">
              {{ 'PaymentIn.Form.NewBalance' | translate }}
            </lib-label>
            <lib-text-input
              type="text"
              formControlName="newBalance"
              class="newBalance"
              [placeholder]="'PaymentIn.Form.PlaceholderNewBalance' | translate"
              [readOnly]="true"
            />
          </lib-form-group>
        </div>
      </div>
  </form>

  <div class="entry_tableCont">
    <div class="card">
      <p-table
        [value]="tableData"
        dataKey="id"
        styleClass="p-datatable-gridlines p-datatable-striped"
        [tableStyle]="{ 'min-width': '50rem' }"
      >
        <ng-template pTemplate="header">
          <tr>
            <th style="width: 10%">{{ 'PaymentIn.Table.Amount' | translate }}</th>
            <th style="width: 15%">{{ 'PaymentIn.Table.LocalAmount' | translate }}</th>
            <th style="width: 15%">{{ 'PaymentIn.Table.PaymentMethod' | translate }}</th>
            <th style="width: 20%">{{ 'PaymentIn.Table.PaymentMethodDetails' | translate }}</th>
            <th style="width: 10%">{{ 'PaymentIn.Table.PaidBy' | translate }}</th>
            <th style="width: 10%">{{ 'PaymentIn.Table.PaidByDetails' | translate }}</th>
            <th style="width: 10%">{{ 'PaymentIn.Table.LinkedGLAccount' | translate }}</th>
            <th style="width: 10%">{{ 'PaymentIn.Table.CostCenter' | translate }}</th>
            <th style="width: 10%">{{ 'PaymentIn.Table.Notes' | translate }}</th>
            <th style="width: 10%">
              {{ 'EditJournal.Actions' | translate }}
            </th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-journalLine let-rowIndex="rowIndex">
          <tr [formGroup]="journalLine">
            <td [pEditableColumn]="journalLine.accountId" pEditableColumnField="accountId">
              <p-cellEditor>
                <ng-template pTemplate="input">
                  <div class="flex gap-2 align-items-center">
                    <lib-select
                      formControlName="accountId"
                      optionValue="id"
                      optionLabel="displayName"
                    >
                    </lib-select>

                    <i class="pi pi-search search-circle" (click)="openDialog()"></i>
                  </div>
                </ng-template>
                <ng-template pTemplate="output">
                  {{ journalLine.get('accountCode').value }}
                </ng-template>
              </p-cellEditor>
              <lib-field-validations [appControl]="journalLine.controls['accountId']">
              </lib-field-validations>
            </td>
            <td>
              {{ journalLine.controls['accountName']?.value }}
            </td>
            <td>
              <lib-text-input formControlName="lineDescription"> </lib-text-input>
              <lib-field-validations [appControl]="journalLine.controls['lineDescription']">
              </lib-field-validations>
            </td>
            <td class="hidden">{{ journalLine.get('currencyId').value }}</td>
            <td
              [pEditableColumn]="journalLine.controls['debitAmount']"
              pEditableColumnField="debitAmount"
            >
              <p-cellEditor>
                <ng-template pTemplate="input">
                  <lib-text-input formControlName="debitAmount" type="number"></lib-text-input>
                </ng-template>
                <ng-template pTemplate="output">
                  {{ journalLine.controls['debitAmount'].value | numberFormat }}
                </ng-template>
              </p-cellEditor>
              <lib-field-validations [appControl]="journalLine"> </lib-field-validations>
            </td>
            <td
              [pEditableColumn]="journalLine.controls['creditAmount']"
              pEditableColumnField="creditAmount"
            >
              <p-cellEditor>
                <ng-template pTemplate="input">
                  <lib-text-input formControlName="creditAmount" type="number"></lib-text-input>
                </ng-template>
                <ng-template pTemplate="output">
                  {{ journalLine.controls['creditAmount'].value | numberFormat }}
                </ng-template>
              </p-cellEditor>
              <lib-field-validations [appControl]="journalLine"> </lib-field-validations>
            </td>

            <td>
              {{ journalLine.get('currency').value }}
            </td>
            <td>
              <lib-form-group>
                <lib-text-input type="number" formControlName="currencyRate"></lib-text-input>
                <lib-field-validations [appControl]="journalLine?.get('currencyRate')">
                </lib-field-validations>
              </lib-form-group>
            </td>
            <td>
              {{ journalLine.controls['debitAmountLocal'].value | numberFormat }}
            </td>
            <td>
              {{ journalLine.controls['creditAmountLocal'].value | numberFormat }}
            </td>
            <td>
              <img src="assets/images/groups.png" />

              <img src="assets/images/groups-mandtory-optional.png" alt="" class="pointer" />
              <img class="pointer" src="assets/images/costcenterfull.png" />
            </td>
            <td>
              <img src="assets/images/table/delete.svg" class="pointer" alt="" />
            </td>
          </tr>
        </ng-template>
        <ng-template pTemplate="footer">
          <tr>
            <td class="total"></td>
            <td class="total"></td>
          </tr>
        </ng-template>
      </p-table>

      <div class="add_new">
        <button class="btn" type="button" >
          {{ 'add_new_line' | translate }}
        </button>
      </div>
    </div>
  </div>
  <div class="btn_group">
    <div class="grid">
      <div class="md:col-3">
        <div class="grid">
          <div class="md:col-6">
            <lib-button-micro
              title="{{ 'Cancel' | translate }}"
              nameClass="cancel"
              widthNumber="100%"
            >
            </lib-button-micro>
          </div>
          <div class="md:col-6">
            <div>
              <lib-button-micro
                title="{{ 'Save' | translate }}"
                nameClass="save"
                widthNumber="100%"
                type="button"
              >
              </lib-button-micro>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="btn_group">
    <div class="grid">
      <div class="md:col-3">
        <div class="grid">
          <div class="md:col-6">
            <lib-button-micro
              title="Payment method"
              nameClass="save"
              widthNumber="100%"
              (click)="openDialog()"
              >
            </lib-button-micro>
          </div>
        </div>
      </div>
    </div>
  </div>



</lib-page-content>
